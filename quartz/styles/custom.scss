@use "./base.scss";

/*
Zenn-inspired Dark Theme for Quartz
Based on Zenn's dark-blue color scheme
https://zenn.dev
*/

// ============================================================================
// Variables
// ============================================================================

$mobile-breakpoint: 768px;
$mobile-padding: 0.5rem;

// ============================================================================
// Mixins
// ============================================================================

// Mobile-only styles
@mixin mobile {
  @media (max-width: $mobile-breakpoint) {
    @content;
  }
}

// Remove padding/margin on mobile for full-width display
@mixin mobile-full-width {
  @include mobile {
    padding-left: 0 !important;
    padding-right: 0 !important;
    margin-left: 0 !important;
    margin-right: 0 !important;
  }
}

// Add horizontal padding on mobile
@mixin mobile-horizontal-padding {
  @include mobile {
    padding-left: $mobile-padding;
    padding-right: $mobile-padding;
  }
}

// Article title styling (shared between themes)
@mixin article-title-style {
  text-align: center;
  font-size: 2.2rem;
  font-weight: 700;
  line-height: 1.3;
  margin-bottom: 0.5rem;
  color: var(--tx1) !important;

  @include mobile {
    font-size: 1.6rem;
    padding-left: $mobile-padding;
    padding-right: $mobile-padding;
  }
}

// Article metadata styling (shared between themes)
@mixin article-meta-style {
  text-align: center;
  font-size: 0.85rem;
  color: var(--tx3);
  margin-bottom: 1rem;

  @include mobile-horizontal-padding;

  // Mobile: wrap items when width is insufficient
  @include mobile {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 0.25rem 0.5rem; // row-gap: 0.25rem, column-gap: 0.5rem
  }
}

// Article tags styling (shared between themes)
@mixin article-tags-style {
  justify-content: flex-start;
  margin-bottom: 1rem;

  &::before {
    content: none !important;
    display: none !important;
  }

  @include mobile-horizontal-padding;
}

// Article content area styling (shared between themes)
@mixin article-content-style {
  background-color: var(--bg4) !important;
  border: 1px solid var(--ui2) !important;
  border-radius: 8px;
  padding: 2rem;

  @include mobile {
    padding: 1rem 0;
    border-radius: 0;
    background-color: var(--bg1) !important;
    border: 1px solid var(--bg1) !important;
  }

  // Main text color
  & > p, & > ul > li, & > ol > li, & > blockquote, & > div:not(figure) {
    color: var(--tx1) !important;
  }

  // Headings
  h1, h2, h3, h4, h5, h6 {
    color: var(--tx1) !important;
  }

  // Links
  a {
    color: var(--ax1) !important;
    text-decoration: none;

    &:hover {
      color: var(--ax3) !important;
    }
  }

  // Mobile: add minimal padding to text elements
  @include mobile {
    & > p, & > blockquote, & > div:not(figure) {
      padding-left: $mobile-padding;
      padding-right: $mobile-padding;
    }

    // Lists need more padding to accommodate markers
    & > ul, & > ol {
      padding-left: calc($mobile-padding + 1.5rem);
      padding-right: $mobile-padding;
    }

    h1, h2, h3, h4, h5, h6 {
      padding-left: $mobile-padding;
      padding-right: $mobile-padding;
    }
  }

  // Code blocks
  figure[data-rehype-pretty-code-figure] {
    border: none !important;
    margin: 0 !important;
    padding: 0 !important;
  }

  pre {
    border: none !important;
    border-radius: 0 !important;
    padding: 0 !important;
    margin: 0 !important;
    overflow-x: auto;
  }

  // Inline code
  :not(pre) > code {
    padding: 0.2em 0.4em;
    border-radius: 4px;
    font-size: 0.9em;
  }
}

// ============================================================================
// Global Styles
// ============================================================================

// Hide footer
footer {
  display: none !important;
}

// Scrap Notes logo styling
.page-title {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Helvetica Neue', Arial, sans-serif !important;
  font-weight: 700 !important;
  letter-spacing: 0.02em !important;
  font-size: 1.75rem !important;
  color: var(--tx1) !important;
  text-transform: none !important;

  @include mobile {
    margin-left: $mobile-padding !important;
  }

  a {
    color: var(--tx1) !important;

    &:hover {
      opacity: 0.8;
    }
  }
}

// ============================================================================
// Theme: Light Mode
// ============================================================================

[saved-theme="light"] {
  // Color palette
  --bg1: #FFFFFF;
  --bg2: #f6f8fa;
  --bg3: #f3f4f6;
  --bg4: #FFFFFF;
  --bg5: #f6f8fa;
  --ui1: #e5e7eb;
  --ui2: #d1d5db;
  --ui3: #9ca3af;
  --tx1: #1a1a1a;
  --tx2: #6b7280;
  --tx3: #9ca3af;
  --ax1: #3ea8ff;
  --ax2: #0f83fd;
  --ax3: #0369a1;
  --hl1: rgba(62, 168, 255, 0.15);

  color: var(--tx1);
  background: var(--bg1);

  // Mobile: unified background
  @include mobile {
    html, body, #quartz-body {
      background-color: var(--bg1) !important;
    }

    .sidebar.left,
    .explorer-content {
      background-color: var(--bg1) !important;
    }
  }

  h1, h2, h3, h4, h5, h6 {
    color: var(--tx1);
  }

  pre {
    background-color: var(--bg2) !important;
  }

  :not(pre) > code {
    background-color: var(--bg3) !important;
    color: var(--tx1) !important;
  }

  .page-header .article-title {
    @include article-title-style;
  }

  .page-header .content-meta {
    @include article-meta-style;
  }

  .page-header .tags {
    @include article-tags-style;
  }

  @include mobile {
    body, .page, .center, .page-header {
      @include mobile-full-width;
    }
  }

  .center > article {
    @include article-content-style;

    :not(pre) > code {
      background-color: var(--ui1) !important;
      color: var(--tx1) !important;
    }
  }

  .graph-outer,
  .global-graph-container {
    background-color: var(--bg4) !important;
    border: 1px solid var(--ui2) !important;
    border-radius: 8px;
  }
}

// ============================================================================
// Theme: Dark Mode
// ============================================================================

[saved-theme="dark"] {
  // Color palette
  --bg1: #151e2c;
  --bg2: #0d223a;
  --bg3: #162c49;
  --bg4: #151e2c;
  --bg5: #0b2c53;
  --ui1: #1b324a;
  --ui2: #2e445c;
  --ui3: #344c69;
  --tx1: #ecf5ff;
  --tx2: #a4bcd5;
  --tx3: #7a9cc6;
  --ax1: #3ea8ff;
  --ax2: #0f83fd;
  --ax3: #0868ce;
  --hl1: rgba(62, 168, 255, 0.2);

  color: var(--tx1);
  background: var(--bg1);

  // Mobile: unified background
  @include mobile {
    html, body, #quartz-body {
      background-color: var(--bg1) !important;
    }

    .sidebar.left,
    .explorer-content {
      background-color: var(--bg1) !important;
    }
  }

  h1, h2, h3, h4, h5, h6 {
    color: var(--tx1);
  }

  pre {
    background-color: var(--bg5) !important;
  }

  :not(pre) > code {
    background-color: var(--bg3) !important;
    color: var(--tx1) !important;
  }

  .page-header .article-title {
    @include article-title-style;
  }

  .page-header .content-meta {
    @include article-meta-style;
  }

  // Tags styling
  .page-header .tags,
  .page-listing .tags,
  .section > .tags {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    margin: 0;
    padding: 0;
    list-style: none;

    &::before,
    &::after {
      content: "" !important;
      display: none !important;
    }

    li {
      margin: 0;

      a {
        display: inline-block;
        padding: 0.25rem 0.75rem;
        background-color: var(--ui1);
        color: var(--tx2);
        font-size: 0.8rem;
        border-radius: 4px;
        text-decoration: none;
        transition: all 0.2s ease;

        &::before {
          content: "#" !important;
          margin-right: 0.2em;
        }

        &:hover {
          background-color: var(--ax1);
          color: var(--tx1);
        }
      }
    }
  }

  .page-header .tags {
    @include article-tags-style;
  }

  @include mobile {
    body, .page, .center, .page-header {
      @include mobile-full-width;
    }
  }

  .center > article {
    @include article-content-style;

    :not(pre) > code {
      background-color: var(--bg3) !important;
      color: var(--tx1) !important;
    }
  }

  .graph-outer,
  .global-graph-container {
    background-color: var(--bg4) !important;
    border: 1px solid var(--ui2) !important;
    border-radius: 8px;
  }
}

// ============================================================================
// Typography
// ============================================================================

body {
  --font-text-size: 16px;
  --font-small: 13px;
  --font-smaller: 11px;
  --font-smallest: 10px;

  --normal-weight: 400;
  --bold-weight: 600;

  --h1: 1.125em;
  --h2: 1.05em;
  --h3: 1em;
  --h4: 0.90em;
  --h5: 0.85em;
  --h6: 0.85em;

  --h1-weight: 600;
  --h2-weight: 600;
  --h3-weight: 500;
  --h4-weight: 500;
  --h5-weight: 500;
  --h6-weight: 400;

  --image-radius: 8px;
  --border-width: 1px;
}

h1 {
  font-size: var(--h1);
  font-weight: var(--h1-weight);
}

h2 {
  font-size: var(--h2);
  font-weight: var(--h2-weight);
}

h3 {
  font-size: var(--h3);
  font-weight: var(--h3-weight);
}

h4 {
  font-size: var(--h4);
  font-weight: var(--h4-weight);
}

h5 {
  font-size: var(--h5);
  font-weight: var(--h5-weight);
}

h6 {
  font-size: var(--h6);
  font-weight: var(--h6-weight);
}

img {
  border-radius: var(--image-radius);
}

a {
  font-weight: var(--normal-weight);

  &:hover {
    opacity: 0.8;
  }
}

code {
  font-size: 0.85em;
}

ol > li::marker,
ul > li::marker {
  color: var(--tx3);
}

// ============================================================================
// Tables
// ============================================================================

table {
  border: var(--border-width) solid var(--ui1);
  border-collapse: collapse;

  th, td {
    padding: 4px 10px;
    border: none;
  }

  thead {
    border-bottom: var(--border-width) solid var(--ui2);
  }

  tbody tr {
    border-bottom: var(--border-width) solid var(--ui1);

    &:last-child {
      border-bottom: none;
    }

    &:hover {
      background-color: var(--bg2);
    }
  }
}

// ============================================================================
// Components
// ============================================================================

// Graph view spacing
.graph-outer,
.global-graph-container {
  margin-top: 2rem;
}

// Explorer
.explorer .title-button h2 {
  font-size: 0.75rem !important;
  font-weight: 400 !important;
}

.folder-container {
  & div > a {
    font-size: 0.8rem !important;
    line-height: 1.3rem !important;

    @include mobile {
      font-size: 0.9rem !important;
      line-height: 1.5rem !important;
    }
  }

  & div > button span {
    font-size: 0.8rem !important;
    line-height: 1.3rem !important;

    @include mobile {
      font-size: 0.9rem !important;
      line-height: 1.5rem !important;
    }
  }
}

.explorer-content ul li > a {
  font-size: 0.8rem !important;
  line-height: 1.3rem !important;

  @include mobile {
    font-size: 0.9rem !important;
    line-height: 1.5rem !important;
  }
}

// Backlinks
.backlinks > ul.overflow {
  list-style: none !important;
  padding: 0 !important;
  overflow-x: hidden !important;
  overflow-y: visible !important;
  max-height: none !important;

  &::-webkit-scrollbar {
    display: none !important;
    width: 0 !important;
    height: 0 !important;
  }

  scrollbar-width: none !important;

  & > li {
    list-style: none !important;

    & > a {
      word-wrap: break-word !important;
      overflow-wrap: break-word !important;
      display: block !important;
    }
  }
}

// ============================================================================
// Page Listing (Folder Pages) & Recent Notes
// ============================================================================

.page-listing,
.recent-notes {
  margin-top: 2rem;
  margin-bottom: 3rem;

  & > h3 {
    font-size: 1.2rem;
    font-weight: 600;
    margin-bottom: 1rem;
    color: var(--tx1);
  }
}

// Add horizontal line after recent notes
.recent-notes::after {
  content: "";
  display: block;
  margin-top: 2rem;
  border-bottom: 2px solid var(--lightgray);
}

.page-listing,
.recent-notes {
  & > p {
    color: var(--tx2);
    font-size: 0.9rem;
    margin-bottom: 1.5rem;

    @include mobile-horizontal-padding;
  }

  ul.section-ul {
    display: flex;
    flex-direction: column;
    gap: 1rem;
    list-style: none;
    padding: 0;
    margin: 0;
  }

  li.section-li {
    margin: 0;

    & > .section {
      position: relative;
      z-index: 0;
      display: grid;
      grid-template-columns: 1fr auto;
      grid-template-rows: auto auto;
      gap: 0.5rem 1rem;
      background-color: var(--bg3);
      border: 1px solid var(--ui1);
      border-radius: 8px;
      padding: 1rem 1.5rem;
      transition: all 0.2s ease;
      cursor: pointer;

      @include mobile {
        grid-template-columns: 1fr;
        grid-template-rows: auto auto auto;
        padding: 1rem 0;
        border-radius: 0;
        border-left: none;
        border-right: none;
      }

      &:hover {
        background-color: var(--bg2);
        border-color: var(--ui2);
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
        transform: translateX(4px);
      }

      & > .desc {
        grid-column: 1;
        grid-row: 1;

        h3 {
          margin: 0;
          font-size: 1.05rem;
          font-weight: 600;
          line-height: 1.4;

          a {
            color: var(--tx1);
            text-decoration: none;
            transition: color 0.2s ease;

            &::after {
              content: "";
              position: absolute;
              inset: 0;
              border-radius: 8px;
            }

            &:hover {
              color: var(--ax1);
            }
          }
        }

        @include mobile-horizontal-padding;
      }

      & > .meta {
        position: relative;
        z-index: 0;
        grid-column: 2;
        grid-row: 1;
        margin: 0;
        opacity: 0.7;
        font-size: 0.85rem;
        color: var(--tx3);
        text-align: right;
        align-self: center;

        @include mobile {
          grid-column: 1;
          grid-row: 2;
          text-align: left;
          padding-left: $mobile-padding;
          padding-right: $mobile-padding;
        }
      }

      & > .tags {
        position: relative;
        z-index: 1;
        grid-column: 1 / -1;
        grid-row: 2;
        justify-content: flex-start;
        display: flex !important;
        flex-wrap: wrap;
        gap: 0.5rem;

        @include mobile {
          display: flex !important;
          grid-row: 3;
          grid-column: 1;
          padding-left: $mobile-padding;
          padding-right: $mobile-padding;
        }
      }
    }
  }
}
